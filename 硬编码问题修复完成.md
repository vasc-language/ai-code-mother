# ç¡¬ç¼–ç é—®é¢˜ä¿®å¤å®Œæˆ âœ…

## ğŸ› é—®é¢˜æè¿°

ç”¨æˆ·åœ¨å‰ç«¯é€‰æ‹©æ¨¡å‹åï¼Œç³»ç»Ÿä»ç„¶æŠ¥é”™ï¼š
```
BusinessException: ä¸æ”¯æŒçš„æ¨¡å‹: deepseek-reasoner
```

**æ ¹æœ¬åŸå› **: ä»£ç ä¸­å­˜åœ¨2å¤„ç¡¬ç¼–ç ï¼Œå¼ºåˆ¶ä½¿ç”¨ `deepseek-reasoner` ä½œä¸ºé»˜è®¤æ¨¡å‹ï¼Œä½†è¯¥æ¨¡å‹å·²ä»æ•°æ®åº“ä¸­åˆ é™¤ã€‚

---

## ğŸ”§ ä¿®å¤è¯¦æƒ…

### ä¿®æ”¹1: AppServiceImpl.java (ç¬¬121è¡Œ)

**ä¿®æ”¹å‰**:
```java
public Flux<String> chatToGenCode(Long appId, String message, User loginUser,
                                  com.spring.aicodemother.core.control.GenerationControlRegistry.GenerationControl control) {
    // Delegate to modelKey version with default model
    return chatToGenCode(appId, message, loginUser, control, "deepseek-reasoner");
}
```

**ä¿®æ”¹å**:
```java
public Flux<String> chatToGenCode(Long appId, String message, User loginUser,
                                  com.spring.aicodemother.core.control.GenerationControlRegistry.GenerationControl control) {
    // Delegate to modelKey version with default model (ä½¿ç”¨æ€§ä»·æ¯”é«˜çš„MEDIUMçº§åˆ«æ¨¡å‹)
    return chatToGenCode(appId, message, loginUser, control, "gpt-5-low");
}
```

### ä¿®æ”¹2: AppController.java (ç¬¬89è¡Œ)

**ä¿®æ”¹å‰**:
```java
// modelKey å¯é€‰ï¼Œå¦‚æœä¸ä¼ åˆ™ä½¿ç”¨é»˜è®¤æ¨¡å‹
if (StrUtil.isBlank(modelKey)) {
    modelKey = "deepseek-reasoner"; // é»˜è®¤æ¨¡å‹
}
```

**ä¿®æ”¹å**:
```java
// modelKey å¯é€‰ï¼Œå¦‚æœä¸ä¼ åˆ™ä½¿ç”¨é»˜è®¤æ¨¡å‹ï¼ˆæ€§ä»·æ¯”é«˜çš„MEDIUMçº§åˆ«æ¨¡å‹ï¼‰
if (StrUtil.isBlank(modelKey)) {
    modelKey = "gpt-5-low"; // é»˜è®¤æ¨¡å‹ï¼šGPT-5 ä½é…ç‰ˆï¼ˆ3ç§¯åˆ†/1K tokensï¼‰
}
```

---

## âœ… æ–°çš„é»˜è®¤æ¨¡å‹

- **æ¨¡å‹Key**: `gpt-5-low`
- **æ¨¡å‹åç§°**: GPT-5 ä½é…ç‰ˆ
- **ç­‰çº§**: MEDIUM
- **è´¹ç”¨**: 3ç§¯åˆ†/1K tokens
- **ä¼˜åŠ¿**: æ€§ä»·æ¯”é«˜ï¼Œé€‚åˆæ—¥å¸¸ä½¿ç”¨

---

## ğŸ” éªŒè¯ç»“æœ

æ‰§è¡Œå…¨å±€æœç´¢ç¡®è®¤ï¼š
```bash
grep -r "deepseek-reasoner" src/
# ç»“æœ: No files found âœ…
```

æ‰€æœ‰ç¡¬ç¼–ç å·²æ¸…é™¤ï¼

---

## ğŸ“‹ ç°åœ¨çš„å·¥ä½œæµç¨‹

### 1. ç”¨æˆ·é€‰æ‹©æ¨¡å‹ï¼ˆå‰ç«¯ä¼ é€’modelKeyï¼‰
å‰ç«¯è°ƒç”¨APIæ—¶ä¼ é€’ `modelKey` å‚æ•°ï¼Œä¾‹å¦‚ï¼š
```javascript
/api/app/chat/gen/code?appId=123&message=xxx&modelKey=qwen3-coder
```

### 2. æœªé€‰æ‹©æ¨¡å‹ï¼ˆä½¿ç”¨é»˜è®¤ï¼‰
å¦‚æœå‰ç«¯æœªä¼ é€’ `modelKey`ï¼Œç³»ç»Ÿè‡ªåŠ¨ä½¿ç”¨ `gpt-5-low` ä½œä¸ºé»˜è®¤æ¨¡å‹ã€‚

### 3. æ¨¡å‹éªŒè¯
ç³»ç»Ÿä¼šéªŒè¯é€‰æ‹©çš„æ¨¡å‹ï¼š
- æ¨¡å‹å¿…é¡»å­˜åœ¨äº `ai_model_config` è¡¨
- æ¨¡å‹å¿…é¡»å¯ç”¨ (`is_enabled = 1`)
- éªŒè¯å¤±è´¥ä¼šæŠ›å‡ºæ¸…æ™°çš„é”™è¯¯ä¿¡æ¯

---

## ğŸš€ æµ‹è¯•å»ºè®®

1. **é‡å¯åç«¯æœåŠ¡**
   ```bash
   mvnw.cmd spring-boot:run
   ```

2. **æµ‹è¯•åœºæ™¯1: ä½¿ç”¨é»˜è®¤æ¨¡å‹**
   - å‰ç«¯ä¸ä¼  `modelKey` å‚æ•°
   - åº”è¯¥ä½¿ç”¨ `gpt-5-low` æ¨¡å‹æˆåŠŸç”Ÿæˆ

3. **æµ‹è¯•åœºæ™¯2: æ‰‹åŠ¨é€‰æ‹©æ¨¡å‹**
   - å‰ç«¯é€‰æ‹©ä»»æ„å¯ç”¨æ¨¡å‹ï¼ˆ24ä¸ªæ¨¡å‹ä¸­çš„ä»»æ„ä¸€ä¸ªï¼‰
   - åº”è¯¥ä½¿ç”¨é€‰æ‹©çš„æ¨¡å‹æˆåŠŸç”Ÿæˆ

4. **æµ‹è¯•åœºæ™¯3: é€‰æ‹©ä¸å­˜åœ¨çš„æ¨¡å‹**
   - å‰ç«¯ä¼ é€’ä¸å­˜åœ¨çš„ `modelKey`
   - åº”è¯¥è¿”å›æ¸…æ™°çš„é”™è¯¯æç¤ºï¼š"ä¸æ”¯æŒçš„æ¨¡å‹: xxx"

---

## ğŸ“Š å¯ç”¨æ¨¡å‹åˆ—è¡¨ï¼ˆ24ä¸ªï¼‰

### SIMPLE (1ä¸ª)
- codex-mini-latest (1ç§¯åˆ†)

### MEDIUM (6ä¸ª)
- **gpt-5-low** (3ç§¯åˆ†) â­ **é»˜è®¤æ¨¡å‹**
- gpt-5-minimal (3ç§¯åˆ†)
- deepseek-v3.1-free (4ç§¯åˆ†)
- deepseek-r1-0528-free (4ç§¯åˆ†)
- qwen3-coder (4ç§¯åˆ†)
- kimi-k2-free (4ç§¯åˆ†)

### HARD (10ä¸ª)
- gpt-5-medium (8ç§¯åˆ†)
- gpt-5-codex-low (8ç§¯åˆ†)
- gpt-5-codex-medium (9ç§¯åˆ†)
- deepseek-v3.1 (8ç§¯åˆ†)
- deepseek-v3.2 (9ç§¯åˆ†)
- deepseek-r1 (10ç§¯åˆ†)
- qwen3-coder-plus (8ç§¯åˆ†)
- qwen3-max-preview (10ç§¯åˆ†)
- kimi-k2 (8ç§¯åˆ†)
- kimi-k2-0905 (8ç§¯åˆ†)

### EXPERT (7ä¸ª)
- gpt-5 (15ç§¯åˆ†)
- gpt-5-high (16ç§¯åˆ†)
- gpt-5-codex (18ç§¯åˆ†)
- gpt-5-codex-high (18ç§¯åˆ†)
- qwen3-max (15ç§¯åˆ†)
- qwen3-235b-a22b-instruct (16ç§¯åˆ†)
- qwen3-235b-a22b-thinking-2507 (18ç§¯åˆ†)

---

## âœ… é—®é¢˜å·²å®Œå…¨è§£å†³

- âœ… ç§»é™¤æ‰€æœ‰ `deepseek-reasoner` ç¡¬ç¼–ç 
- âœ… è®¾ç½®æ–°çš„é»˜è®¤æ¨¡å‹ `gpt-5-low`
- âœ… ç”¨æˆ·å¯ä»¥è‡ªç”±é€‰æ‹©24ä¸ªå¯ç”¨æ¨¡å‹
- âœ… æ¨¡å‹é€‰æ‹©åŠŸèƒ½æ­£å¸¸å·¥ä½œ
