# AICodeHub 部署检查清单

> 使用此清单确保部署过程中不遗漏任何步骤

## ✅ 部署前准备

### 服务器准备
- [ ] Ubuntu 20.04/22.04 LTS 服务器已准备
- [ ] 拥有 sudo 权限
- [ ] 服务器配置满足要求（2核4GB+）
- [ ] 磁盘空间 >20GB
- [ ] 已获得公网 IP 地址
- [ ] SSH 访问正常

### 外部服务准备
- [ ] MySQL 8.0+ 已安装或准备安装
- [ ] Redis 6.0+ 已安装或准备安装
- [ ] DeepSeek API Key 已获取
- [ ] 阿里云 DashScope API Key 已获取
- [ ] 腾讯云 COS 配置信息已获取
  - [ ] SecretId
  - [ ] SecretKey
  - [ ] Bucket Name
- [ ] SMTP 邮件服务已配置（QQ邮箱）

### 域名和网络
- [ ] 域名已注册（可选）
- [ ] 域名 DNS 已解析到服务器 IP
- [ ] 80 端口可访问
- [ ] 443 端口可访问（HTTPS）

---

## ✅ 部署过程

### 1. 上传部署包
- [ ] 将 deployment/ 文件夹上传到服务器
- [ ] 文件完整性检查
- [ ] 文件权限正确

### 2. 环境检查
- [ ] 运行 `check_env.sh` 脚本
- [ ] 所有必检项通过
- [ ] 警告项已处理或忽略

### 3. 安装依赖
- [ ] Java 21 已安装
- [ ] MySQL 已安装并运行
- [ ] Redis 已安装并运行
- [ ] Nginx 已安装
- [ ] Chromium 已安装

### 4. 数据库初始化
- [ ] 运行 `init_database.sh`
- [ ] 数据库创建成功
- [ ] 12 张表创建成功
- [ ] 初始数据导入成功
- [ ] 默认用户账号已创建

### 5. 应用部署
- [ ] 后端 JAR 包已复制到 `/var/app/aicodehub/`
- [ ] 前端文件已复制到 `/var/www/aicodehub/`
- [ ] 目录权限正确设置
- [ ] 应用用户 aicode 已创建

### 6. 配置文件
- [ ] Nginx 配置已复制
- [ ] Nginx 配置中的域名已修改
- [ ] Nginx 配置测试通过 (`nginx -t`)
- [ ] Systemd 服务配置已复制
- [ ] Systemd 配置已重载 (`daemon-reload`)

### 7. 启动服务
- [ ] 后端服务启动成功
- [ ] Nginx 重启成功
- [ ] 服务设置为开机自启

---

## ✅ 部署后验证

### 基础健康检查
- [ ] 后端健康检查通过: `curl http://localhost:8080/api/health/`
- [ ] 前端页面可访问: `curl http://localhost/`
- [ ] Nginx 运行正常
- [ ] MySQL 连接正常
- [ ] Redis 连接正常

### 功能测试
- [ ] 前端页面正常显示
- [ ] 可以正常登录（admin/12345678）
- [ ] API 文档可访问: `/api/doc.html`
- [ ] 用户注册功能正常
- [ ] 代码生成功能正常（SSE 流式传输）
- [ ] 文件上传下载正常

### 日志检查
- [ ] 后端日志无严重错误: `journalctl -u aicodehub -n 100`
- [ ] Nginx 访问日志正常: `/var/log/nginx/access.log`
- [ ] Nginx 错误日志无严重错误: `/var/log/nginx/error.log`
- [ ] MySQL 日志正常

---

## ✅ 安全加固

### 防火墙配置
- [ ] UFW 防火墙已启用
- [ ] 80/tcp 端口已开放
- [ ] 443/tcp 端口已开放
- [ ] 8080/tcp 端口已禁止外网访问
- [ ] SSH 端口访问已限制（可选）

### SSL/HTTPS 配置
- [ ] Certbot 已安装
- [ ] SSL 证书已获取
- [ ] HTTPS 访问正常
- [ ] HTTP 自动跳转到 HTTPS
- [ ] 证书自动续期已配置

### 账号安全
- [ ] 默认管理员密码已修改
- [ ] 测试账号密码已修改或禁用
- [ ] 数据库 root 密码已修改
- [ ] Redis 密码已配置（可选）

### API 安全
- [ ] API 文档访问已限制（仅内网或特定IP）
- [ ] CORS 策略已配置正确
- [ ] Rate Limiting 已配置（可选）

---

## ✅ 性能优化

### JVM 调优
- [ ] 堆内存设置合理（-Xms -Xmx）
- [ ] GC 策略已优化（G1GC）
- [ ] HeapDump 路径已配置

### 数据库优化
- [ ] InnoDB 缓冲池大小已调整
- [ ] 最大连接数已调整
- [ ] 慢查询日志已启用（可选）

### Redis 优化
- [ ] 最大内存已设置
- [ ] 内存淘汰策略已配置
- [ ] 持久化已启用（AOF）

### Nginx 优化
- [ ] Worker 进程数已优化
- [ ] Gzip 压缩已启用
- [ ] 静态文件缓存已配置

---

## ✅ 监控和备份

### 监控配置
- [ ] Prometheus 监控已配置（可选）
- [ ] Grafana 仪表板已配置（可选）
- [ ] 日志轮转已配置
- [ ] 磁盘使用监控已配置

### 备份策略
- [ ] 数据库自动备份脚本已配置
- [ ] 备份保留策略已设置
- [ ] 备份恢复测试已完成
- [ ] 重要配置文件已备份

---

## ✅ 文档和交接

### 文档记录
- [ ] 服务器信息已记录（IP、端口、账号）
- [ ] API Key 和密钥已安全保存
- [ ] 部署配置参数已记录
- [ ] 运维手册已交付

### 团队培训
- [ ] 运维人员已培训服务管理命令
- [ ] 故障排查流程已培训
- [ ] 紧急联系方式已建立

---

## 📋 部署信息记录

### 服务器信息
- **服务器IP**: ___________________
- **域名**: ___________________
- **SSH端口**: ___________________
- **操作系统**: Ubuntu ___________

### 应用信息
- **后端端口**: 8080
- **上下文路径**: /api
- **日志目录**: /var/app/aicodehub/logs
- **临时文件目录**: /var/app/aicodehub/tmp

### 数据库信息
- **MySQL主机**: localhost
- **MySQL端口**: 3306
- **数据库名**: ai_code_mother
- **用户名**: root
- **密码**: ___________________ (请安全保管)

### Redis 信息
- **Redis主机**: localhost
- **Redis端口**: 6379
- **密码**: ___________________ (如果有)

### API 密钥
- **DeepSeek API Key**: sk-___________________
- **DashScope API Key**: sk-___________________
- **COS SecretId**: ___________________
- **COS SecretKey**: ___________________

### 访问地址
- **前端**: http://___________________
- **后端API**: http://___________________/api/
- **API文档**: http://___________________/api/doc.html

---

## ✅ 最终确认

- [ ] 所有检查项已完成
- [ ] 应用运行稳定
- [ ] 文档已归档
- [ ] 部署成功！🎉

---

**部署日期**: ___________________
**部署人员**: ___________________
**签字确认**: ___________________

---

## 📞 问题联系

如有问题，请参考：
- 完整部署指南: `deployment/docs/DEPLOYMENT.md`
- 快速参考手册: `deployment/docs/QUICK_REFERENCE.md`
- 技术支持: GitHub Issues

**祝部署顺利！**
